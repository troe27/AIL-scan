setwd("~/dip_home/nas/chicken_finemapping/QTL/stripes2rqtl_multigen/r_liftover/")
## Genotypes and Phenotypes
load("epi_full_data.RData")
chr_num<-unlist(strsplit(names(full_data$geno),"[.]"))[seq(2,length(unlist(strsplit(names(full_data$geno),"[.]"))),2)]
phe<-as.numeric(full_data$pheno$BW8)
fx1<-as.numeric(full_data$pheno$sex)
# trans-format the genotypes
mrk_geno<-c()
mrks_info<-c()
for(i in 1:length(full_data$geno)){
for(k in 1:ncol(full_data$geno[[i]]$g)){
# define genos based on the most frequent allele
alles<-table(unlist(strsplit(na.omit(full_data$geno[[i]]$g[,k]),"")))
minA<-names(alles[order(alles)])[1]
majA<-names(alles[order(alles)])[2]
oneG<-full_data$geno[[i]]$g[,k]
oneG[oneG==paste(minA,minA,sep="")]<-0
oneG[oneG==paste(minA,majA,sep="")]<-1
oneG[oneG==paste(majA,minA,sep="")]<-1
oneG[oneG==paste(majA,majA,sep="")]<-2
mrk_geno<-cbind(mrk_geno,as.numeric(oneG))
}
mrks_info<-rbind(mrks_info,as.matrix(full_data$geno[[i]]$mrk_info))
}
mrks_info[,2]<- as.numeric(mrks_info[,2])
#save(mrk_geno,mrks_info,file = “data/recoded.genotype.RData”)
#cat(mrk_geno)
##### liftover of marker positions
library("data.table")
library("rtracklayer")
trial_df <- as.data.table(mrks_info)
View(trial_df)
View(mrk_geno)
save(mrk_geno,mrks_info,file = “data/recoded.genotype.RData”)
save(mrk_geno,mrks_info,file="data/recoded.genotype.RData")
save(mrk_geno,mrks_info,file="recoded.genotype.RData")
save(mrk_geno,mrks_info,file="Genotypes_GG5.RData")
View(mrk_geno)
View(mrks_info)
View(full_data)
View(trial_df)
View(full_data)
View(mrk_geno)
View(mrks_info)
View(mrk_geno)
View(mrks_info)
View(mrk_geno)
trial_df <- as.data.table(mrks_info)
liftnames <- trial_df$marker
liftnames
trial_df$marker
trial_df
